<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=GB2312" />
<title>12-2  操作剪贴板</title>
<!-- 通用样式表 -->
<style>
* { font-size:12px; font-family:宋体, Arial; } /*规定了所有的字体样式*/
body { overflow:auto; }
fieldset { margin:10px; }
a { color:navy; }
#d1, #d2 { margin:5px 10px; padding:5px 15px; background-color:white; height:20px; }
</style>
<script>
//全局变量，用于记录上一次获取的URL地址
var lastURL;

//函数“captureClipboard”用于获取剪贴板中的网址
function captureClipboard(){
    //调用“clipboardData”对象的“getData”方法获取剪贴板内容
    var str = clipboardData.getData("Text");
    //使用正则判断其内容是否为符合http协议的URL地址，且此URL地址和上次获取的地址不同
    //因为此函数为不断调用的，为了防止重复获取相同的网址，需要判断此URL地址和上次获取的地址不同
    if(str)if((/^http:\/\//i).test(str) && lastURL!=str){
        //如果符合的话，将此网址存入全局变量“lastURL”中
        lastURL = str;
        //将获取到的网址内容输出到相应“div”中
        //读者可以自行改写此处来实现更加有趣的应用
        $("d2").innerHTML += str + "<br>";
    }
}

//函数“doCopy”用于将相应“div”中的HTML放入剪贴板中
function doCopy(){
    clipboardData.setData("Text", $("d1").innerHTML)
}

function $(str){ return(document.getElementById(str)); }

//页面载入事件
window.onload = function(){
    setInterval(captureClipboard,10);
}
</script>
</head>
<body>
<p>
在下面链接上单击鼠标右键，选择“复制快捷方式”，页面会自动捕获复制的网址。
网址捕获不仅可以获得本页中的剪贴板操作，也可以获得其他应用程序中改变的剪贴板操作。<br/>
<a href="http://www.google.com">Google</a>
</p>
<fieldset>
    <legend>监视剪贴板中的网址：</legend>
    <div id="d2"></div>
</fieldset>
<fieldset>
    <legend>
        <a href="javascript:doCopy();void(0);">拷贝此处内容</a>
    </legend>
    <div id="d1">
        腾讯体育记者秦云重庆报道似乎输球输出了希望成了中国足坛的一句流行语。
        今天下午2：3的结果，不仅使中国队第27次输给了韩国队，也让中国队执行主教练福拉多向记者们宣布：
        “在这场比赛里，我们主要是收获了信心，队员们能够在场上放开打，面对对手不害怕。 ...
    </div>
</fieldset>
</body>
</html>