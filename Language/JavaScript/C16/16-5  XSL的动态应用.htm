<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=GB2312" />
<title>16-5  XSL的动态应用</title>
<style>
* { font-size:12px; font-family:宋体, Arial; } /*规定了所有的字体样式*/
body { overflow:auto; }
th { cursor:pointer; }
</style>
<script>
var xml, xsl;
//函数“$”根据指定字符串获取相应ID的对象
function $(str){ return(document.getElementById(str)); }
//窗体载入完毕时初始化
window.onload = function(){
    //创建XML控件
    xml = new ActiveXObject("Microsoft.XMLDOM");
    xsl = new ActiveXObject("Microsoft.XMLDOM");
    //载入XML数据
    xml.load("\\\\192.168.1.151\\F$\\hutia\\book\\JavaScript入门到精通\\代码\\inc\\data\\16-1.xml");
    //载入XSL样式表
    xsl.load("\\\\192.168.1.151\\F$\\hutia\\book\\JavaScript入门到精通\\代码\\inc\\data\\16-5.xsl");
    //执行XML至HTML的转换
    $("hutia").innerHTML = xml.transformNode(xsl);
}
//函数“orderby”按照指定的XML字段进行排序
//此函数在生成的表头单元格被鼠标单击时调用
function orderby(name){
    var orderNode;
    //获取XSL文档中的“order-by”属性节点
    orderNode = xsl.selectSingleNode("//@order-by");
    //确认排序方式为顺序或倒序
    if(orderNode.value == name){
        orderNode.value = "-" + name;
    }else{
        orderNode.value = name;
    }
    //执行XML至HTML的转换
    $("hutia").innerHTML = xml.transformNode(xsl);
}
</script>
</head>
<body>
<!-- 用于输出的容器DIV -->
<div id="hutia"></div>
</body>
</html>