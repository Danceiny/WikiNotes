# 音视频云服务厂商选型调研报告
## 1. 前言
本报告的撰写背景是，公司要在教育培训这一方向上开展新项目，初步预测该项目有一些音视频的课程内容，需要有音视频的技术解决方案提供支持。显而易见的是，核心的基础设施不宜自研，应选择云服务商，因此本报告的宗旨在于根据预估的技术需求，拟定各项技术细则标准，对各家云服务商的音视频服务进行横向对比，并最终给出一个推荐选择的服务商名录。

## 2. 需求
结合竞品以及行业现状来看，“点播”是一种最基础的、最广泛的业务开展形态，直播次之。其中，直播与点播相结合的录播也可认为是点播，但其“直播转点播”的特性对技术的需求会有一些不同。

音视频本身有两大关键需求：播放和版权，此外成本也是一大关键因素。

从产品形态上来说，小程序、h5是项目初期的落脚点，需要充分考虑音视频在小程序和h5中的体验（尤其是播放体验），同时需要保留其他产品形态的可能性。

## 3. 标准
从需求出发，我们对于点播播放的要求是：服务稳定，功能丰富；对点播内容的基本要求是：安全可控。无须赘述的是，出于开发、运维和数据分析的需要，我们需要完善的开发文档、高效的技术响应、够用的统计功能。此外，对“杀手级应用”的追求驱使我们追求极致的产品体验、极致的流畅高清、极低的运营成本等。

云服务基础设施是满足以上需要的关键一环。我们将从以下几个维度考量云服务的适用程度：
- 功能模块
- 价格
- 技术响应
- 文档
- 独特优势

将每个维度展开，得到以下评估标准：
- 【功能模块】
    - CDN：必须项，主要评估缓存质量，因为缓存质量是决定速度的一个重要因素
    - 内容安全保障：
        - 防盗链：必须项，防盗链机制的健壮度
        - 视频加密：可选项，是防盗链的补充
    - 鉴黄鉴暴恐：必须项，维护业务安全的必要功能
    - 拉取：必须项
    - 播放器：必须项
    - 分片：必须项，提升播放体验、降低运营成本的必要功能
    - 截图：必须项，截图方式越灵活越好
    - 水印：必须项
    - 剪辑：必须项
    - 拼接：必须项
    - 转码：必须项，支持程度越高越好
    - 统计：可选项，查看统计结果的方式越灵活越好（提供API和控制台等），统计项越丰富越好
    - 媒体管理：可选项，管理机制越健全越好
    - HTTPS：可选项
    - 直播：可选项
    - 直播转录播：可选项
- 【价格】（下列各项的评估标准均是价格越低越好）
    - 流量
    - 转码
    - 存储
    - 鉴黄鉴暴恐
    - 截图
    - 其他
- 【技术响应】
    - 技术响应方式丰富度：可选的技术响应途径选择越多越好
    - 技术响应速度：厂商承诺的响应及时度，越快越好
- 【文档】
    - 接口文档的完善度、准确度
    - 社区文章的丰富度、活跃度
    - 接口文档的搜索功能、组织结构
    - SDK，sdk的文档清晰度和代码可读性
- 【独特优势】
    - 对微信生态的支持

对于以上所有指标，本文将给出F--到A++的等级评分，对应于0到30的数字评分。

此外，就【价格】而言，考虑到云端资源价格的市场特性，本文按照如下的体量（参考`[在线教育创业型公司](https://help.aliyun.com/document_detail/64032.html?spm=a2c4g.11186623.6.552.3c7f7971y12YHs)`）计算一个月内的成本作为横向对比的主要参考标准：

|存储初始存量|每日新增|视频平均时长|清晰度选项|每日观看|每日截图|其他说明|
|---|---|---|---|---|---|---|
|1000个，1000G|14个，14G|30分钟|标清和高清|1000次（每次一个完整视频），标清高清播放比例3：1|1000次|每日新增视频鉴黄鉴暴恐，全站https，每天下载量1G|

## 4. 对比

根据前期调研讨论，本文选取腾讯云以及阿里云作为高意向选择目标，作着重讨论，并选择七牛云、又拍云、金山云、网易云等参与对比。由于金山云和网易云的公开文档资料较少或不完整，本文将不予讨论。下文将主要对比腾讯云、阿里云和又拍云。

下表4-1是调研得到的各云服务商在各指标下的评价描述。

| 维度 | 对比项 | 腾讯云 | 阿里云 | 七牛云|又拍云 |
| ---- | ------ | ------ | ------ |-----| ------ |
| 功能模块| CDN                      |-| 支持缓存预热|多码率自适应|支持分段缓存|
| 功能模块 | 内容安全保障             | 支持refer和url两种防盗链，支持视频加密|支持refer和url两种防盗链，支持视频加密|支持鉴权和防盗链|支持refer和url两种防盗链|
| 功能模块 | 鉴黄鉴暴恐                   |支持，并且支持设置阈值|支持，分为人工审核和智能审核，智能审核不支持阈值|支持|仅支持鉴黄|
| 功能模块 | 拉取                         | 支持|支持|支持|-|
| 功能模块 | 播放器                       | iOS+Android+Web|iOS+Android+Web|iOS+Android+Web|-|
| 功能模块 | 分片                   | 支持|支持|支持|支持|
| 功能模块 | 截图                         | 支持指定时间点截图，使用指定时间点截图作为封面，采样截图，雪碧图截图。支持转动图（如gif）| 支持指定时间点jpg截图和雪碧图截图|支持采样截图和缩略图|支持mp4和muts分片指定时间点截图，支持视频转码成动图|
| 功能模块 | 水印                         | 支持，并且支持控制台和API管理水印模板|支持，并且支持控制台管理水印|支持|-|
| 功能模块 | 剪辑                  | 支持|支持|-|支持|
| 功能模块 | 拼接                  | 支持|支持|支持|支持|
| 功能模块 | 转码                  | 基本全量支持，默认不支持h265转码（须联系开通）|基本全量支持|基本全量支持|基本全量支持|
| 功能模块 | 统计        | 支持9项统计，有API |支持4项统计，有API|没有API，有控制台|没有API，有控制台|
| 功能模块 | 媒体管理                     | 支持标签、属性和分类 | 支持分类   |-| - |
| 功能模块 | HTTPS                  | 视频上传支持，下载不支持 |-|-|有|
| 功能模块 | 直播                         | 有|有|有|有|
| 功能模块 | 直播转录播                         | 有|有|-|有|
| 价格     | 流量                      | 后付费方案0.24元/GB|后付费方案0.24元/GB|0.24元/GB,0.29元/GB|
| 价格     | 存储                         | 后付费方案0.008元/GB/天|后付费方案0.0049元/GB/天，赠送50GB免费存储|华东0-10GB，0.0049 元/GB/天|CDN流量一比一赠送，超出0.0043元/GB/天|
|价格      |截图    |0.1 元／千张（不超过 1000 张不收费；超过 1000 张（包含）开始收费，收费单价按千张合计，不足 1000 张部分按 1000 张算。|0.1 元/千次|免费（存储收费）|0.2元/千张|
| 价格     | 转码                     | 后付费方案，标清0.022元/分钟，高清0.033元/分钟|后付费方案，高清0.0465/分钟；标清免费，|标清0.0072 元/分钟，高清0.0324 元/分钟|高清0.044/分钟；标清0.017元/分钟|
| 价格     | 鉴黄鉴暴恐            |确定部分1.3元/千张；不确定部分0.4元/千张|后付费，阶梯价格起步价0.1元/分钟）|鉴黄0.85 元／千张，鉴暴恐0.85 元／千张|-|
| 价格     | 其他                |无|视频下载0.24元/GB|音视频拼接0.1 元/千次，文件hash0.5元/GB...|https收费，接口调用收费|
| 独特优势 | 微信生态支持                |微信公众号视频链接发布专项支持|-|-|-|
| 技术响应 | 技术响应方式丰富度   |普通用户可使用工单、7x24小时电话；提供旗舰服务|工单；|工单；|工单；|
|技术响应|技术响应速度|普通用户60min工单响应；旗舰用户15min工单响应；|-|-|-|
|文档|接口文档的完善度、准确度|比较优秀|优秀|比较差|一般|
|文档|社区文章的丰富度、活跃度|比较优秀|优秀|比较差|优秀|
|文档|接口文档的搜索功能、组织结构|搜索体验比较差，文档排布有点混乱|搜索体验一般|很差|一般|
|文档|SDK|客户端和服务端都有，其中只有老版sdk支持点播服务端|客户端和服务端都有，相对比较完善|没有客户端sdk|除了官方sdk还有社区版sdk，客户端和服务端都有|

除去上表中的各项对比，下面补充说明几点：
> 接口调用方面的限制，腾讯云为100次/分钟；阿里云无限制。

根据前文所估计的体量，在一个月内产生的成本如下：

|-|腾讯云（后付费）|阿里云（后付费）| 腾讯云（旗舰版2）|阿里云（套餐3）|七牛云|
|---|---|---|---|---|---|
|流量|1701|1701|-|-|1701|
|转码|693|586|||499|
|存储|866|511|||530|
|审核|491|1260|||643|
|其他|3|15|||6|
|总计|3754|4073|2007+?|1333+?|3379|

补充说明：
> 上表中`?`表示 存储、流量、转码之外的收费，视服务商不同而有差异。以上腾讯云和阿里云的两个预付费方案对比，基本属于同一档位，但仍然存在一些差异（腾讯是50T流量+5000小时转码+3T存储，阿里是36T流量+3000小时转码+3T存储）
> 后付费方案的价格计算中，有以下额外假定：鉴黄截图采样频率为30张/分钟；标清码率为0.0009Gb/s，高清码率为0.0015Gb/s；总的实际存储占用按3倍原始视频大小进行计算。
> 七牛云的转码价格按照`普通帧率（<= 30 帧/秒）`计算，其他服务商未说明。若按照`高帧率（30 帧/秒 < r <= 60 帧/秒）`计算，则七牛云的转码价格乘以2。
> 上表中的`其他`收费事项，因服务商价格方案差异，可参考性比较差。

下表4-2是根据4-1的客观描述所做的评级（不具备功能或者功能描述无法判别好坏等情况视为无法评级，`-`；横向对比绝对优势则直接`A++`，绝对劣势则直接`F--`）。

| 维度     | 对比项                       | 腾讯云 | 阿里云 | 又拍云 |七牛云|
| -------- | ---------------------------- | ------ | ------ | ------ |-----|
| 功能模块 | CDN                         | -      | -    | -    | -|
| 功能模块 | 直播                         | A      | B+      | B     | B|
| 功能模块 | 直播转录播                    | -      | -     | -     | -|
| 功能模块 | 截图                         | A+     | B      | B-    |B-|
| 功能模块 | 播放器                       | A      | B      | -      |B|
| 功能模块 | 拉取                         | B+     | B+     | -    |B+|
| 功能模块 | 分片                 | -     | -     | -|-|
| 功能模块 | 剪辑                 | -     | -      | -|-|
| 功能模块 | 拼接                 | -      | -     | -|-|
| 功能模块 | 水印                         | B+     | B      | -| B-|
| 功能模块 | 鉴黄鉴暴恐                   | A+     | A      | B--    |A++|
| 功能模块 | 统计                         | A      | B      | B+      |B|
| 功能模块 | 调用额度                     | B      | A    | B     |-|
| 功能模块 | 媒体管理                     | A+     | B+     | B      |-|
| 文档     | 接口文档的完善度、准确度     | A      | A      | F--    |B|
| 文档     | 社区文章的丰富度、活跃度     | B+     | A      | D   |B+|
| 文档     | 接口文档的搜索功能、组织结构 | B+     | A      | F--    |B+|
| 文档     | SDK                | B      | A      | B      |B++|
| 技术响应 | 技术响应方式丰富度   | B+     | A      | B      |A|
| 技术响应 | 技术响应速度       | B      | A      | B      |A|
| 独特优势 | 微信生态支持       | A    | -      | -     |-|

## 总结

总结前文，从【功能模块】、【文档】、【技术响应】、【价格】、【独特优势】等方面对腾讯云等三个云服务商进行评级如下：
- 【功能模块】，腾讯云A，阿里云B+，又拍云B-，七牛云B。
- 【文档】阿里云A，腾讯云B++，又拍云B-，七牛云B+。
- 【技术响应】，阿里云B+，腾讯云B+，又拍云B，七牛云B+。
- 【价格】，腾讯云支持后付费（按量，阶梯计费）和用量包，计费粒度最低到天；阿里云支持后付费（按量，阶梯计费）和套餐包，计费粒度最低到小时；又拍云仅支持后付费（按量，无阶梯计费）；七牛云的收费叙述最详细，收费类目也更多。上述三家均支持商务洽谈定价。综上，价格方案相对难以评级，但考虑到经验（阿里云比较贵）和价格方案灵活度（阿里云最优），给出评级为：阿里云A，腾讯云B++，又拍云B+，七牛云B++。
- 【独特优势】，腾讯云的主要优势在于微信生态支持。

综上所述，本文通过公开渠道获取的信息判定，腾讯云和阿里云是相对比较好的两个选择，但目前无从判断其中哪一个更为合适。