---
date: 2016-07-19 09:30
status: public
title: 录入身份证号错误提醒
---

利用Excel公式对身份证号码的录
入进行准确性检验，可确保身份证号
录入的准确性。它可以检验出15位或
18位的身份证号码录入时是否是15位
或18位，而且18位身份证号码（目前绝
大多数为二代身份证了，即都是18位
号），其最后一位是检验码，它是根据
身份证号码前17位数字依照规则计算
出来的，其值0～9或X。一般情况下只
要有一位数字录入错误，依照规则计
算后就会与第18位数字不符。当然不
排除按错误号码计算后恰好与检验码
相符的情况，但这种情况出现的可能
性较低。
利用下面介绍的设置功能，录入
身份证号码时除了可以检测出录入位
数的对错外，同时还可以检验18位的
身份证号码是否合法，及时在录入时
提醒录入者，大大提高身份证号码录
入的准确率。

# 方法一：自动弹出提示信息
这种方法是利用Excel数据有效性
设置自动弹出提示框提醒。
在录入身份证号码前，一般先设
置要录入身份证号码的所在列为“文
本”格式，否则在Excel单元格中输入
的数字位数超过11位后，会变成科学
计数的形式，即身份证号码不能正常
显示（“文本”格式的设置方法这里不
细说）。本文要录入身份证号码的所
在列为C列，那么要设置录入身份证
号码的所在列（C列）的有效性，让其
能在录入身份证号码不正确的时候及
时提醒。
第1步：选定“C列”列头，选菜单
“数据→有效性”（图1）。
第2步：当打开“数据有效性”对话
框后，选择“设置”选项卡的“允许”为
“自定义”。公式引用的位置，把下面
的公式输入进去（图2）：
=OR(LEN(C1)=15,IF(LEN(C1)=18,MID
("10X98765432",MOD(SUM(MID(C1,ROW(I
NDIRECT("1:17")),1)*2^(18-ROW(INDIRECT
("1:17")))),11)+1,1)=RIGHT(C1)))
第3步：公式输入完后，选择“出
错警告”选项卡的“样式”为“信息”。
“标题”下面的内容输入提醒文字如
“注意！”。“出错信息”下面的内容输
入“请您再次确认，您录入的身份证号
码是否准确！”等文字，最后点“确定”
（图3），数据有效性设置就完成了。这
时录入身份证号码完成后如果号码出
错，马上就会自动弹出提醒对话框，提
醒录入人员重新核对，避免了身份证号
码出错了还不知道。
# 方法二：设置辅助列进行提示
这种方法是在身份证号码所在列
旁增加一列用于设置文字提醒。
如在D列设置，D1单元格输入“身
份证号码对错”作表头，在D2单元格输
入下面的公式：
=IF(IF(LEN(C2)=18,MID("10X9876543
2",MOD(SUMPRODUCT(MID(C2,ROW(IND
IRECT("1:17")),1)*2^(18-ROW(INDIRECT("1
:17")))),11)+1,1)=RIGHT(C2),IF(LEN(C2)=15,
ISNUMBER(--TEXT(19&MID(C2,7,6),"#-00-
00")))),"正确","错误")
输入完后按回车，然后向下填充该
公式即可。这样如果身份证号码录入
对了，其对应的右边D列显示“正确”，
不对了显示“错误”。
为了使“错误”显示得更显眼，还
可以在D2单元格输入公式后，先设置一
下D2单元格“条件格式”，再向下填充
该公式。通过单元格“条件格式”，让
显示“错误”的时候，字体变成红色同
时加上底纹颜色，以便更好地区别出
来。设置方法（步骤）：
在D2单元格输入完上面的公式
后，选中D2单元格，选择菜单“格式”，
选择“条件格式”选项，“条件1”选择
“单元格数值”，选择“等于”，接着在
后面框中输入“="错误"”。
选择“格式”按钮，选择“字体”
选项卡，颜色选择“红色”，再选择“图
案”选项卡，在“单元格底纹”下选择
一种底纹颜色“灰色”，点击“确定”按
钮返回，再点击“条件格式”对话框上
的“确定”按钮完成设置（图4）。
再用D2单元格向下填充其公式，就
会连同设置的“条件格式”一起向下填
充了。当录入的身份证号码出错时，其
对应的D列上所在的单元格会显示出红
色字体的“错误”两个字及该单元格被
加上“灰色”底纹的效果，当身份证号
错误时，显示得更显眼（图5）。
当全部身份证号码录入完后，如
果D列不想要了，可以隐藏它或者直接
删除。