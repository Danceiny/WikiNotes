---
date: 2016-04-03 15:20
status: public
title: FAT32文件系统
---

# 硬盘的性能指标
1.转速
2.数据传输率
3.缓存
4.平均寻道时间
5.柱面切换时间
6.平均潜伏期（与转速成反比）
7.平均方位时间

# 寻址方式
1、CHS
Cylinder柱面，Head磁头，Sector扇区
2、LBA
Logic Block Address逻辑块地址，又称线性寻址模式

# 数据存储格式
1. Big-endian
2. Little-endian

# 1.建立文件
假设现在有一个子目录，它的名字是“smart monkey”，我们要在其下建立一个文件“yatou.txt”。
使用的文件系统为 FAT32，簇大小为 4096 字节，我们要建立的文件大小为 5000 个字节。
步骤 1：读取位于卷 0 号扇区的引导扇区，根据引导扇区中的信息定位 FAT 表、数据区和根目录的位
置。
步骤 2：遵照“smart monkey”的位置。查看根目录下的每个目录项，寻找名字为“smart monkey”
且具有目录属性的目录项。找到后，查看它的起始簇号为 3。
  步骤 3：读取 smart monkey 的起始簇（3 号簇）的内容，查找每个目录项，直到找到一个为分配的目录项。
步骤 4：找到可用项后写入文件名“yatou.txt”，并将文件大小和当前时间写入相应的位置。
步骤 5：为文件内容分配簇空间。转到 FAT 表，寻找空闲的位置。发现 4 号 FAT 表项未使用，这就说
明 4 号簇是空闲的。将 4 号簇分配给文件，并在 4 号簇的 FAT 表项内写入结束标记。
步骤 6：将簇号 4 写入文件目录项的起始簇号区域。将文件的钱 4096 字节写入到 4 号簇中，还剩下
904 字节，所以还需要再为其分配一个簇。
步骤 7：在 FAT 表中继续寻找为分配簇，找到 5 号簇为空闲未使用（因其 FAT 表项为 0）。
步骤 8：将文件第一簇（即 4 号簇）的 FAT 表项值改写为 5，将文件的最后 904 字节写入 5 号簇。
步骤 9：在 5 号簇的 FAT 表项内写入结束标记。

# 2.删除文件
现在我们将前面例子中建立的“smart monkey\yatou.txt”文件删除。
步骤 1：从卷 0 号扇区读取引导扇区，根据引导扇区中的信息定位 FAT 表、数据区和根目录的位置。
步骤 2：在根目录下寻找名字为“smart monkey”且具有目录属性的目录项。
  步骤 3：由“smart monkey”的目录项中获取它的起始簇号为 3，到 3 号簇查看“smart monkey”的内容，从中找到文件“yatou.txt”的目录项，提取出它的起始簇号，为 4 号簇。
步骤 4：到 FAT 表中找到该文件的簇链，确定他飞存储位置为 4 号簇和 5 号簇。步骤 5：将 4 号簇和 5 号簇的 FAT 项设置为 0.
  步骤 6：将文件“yatou.txt”的目录项的第一个字节改为 0xE5。
