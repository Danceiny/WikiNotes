## 2019-05-08

DONE

- 谈妥了一个API
- 抖音爬虫的设计

TODO

- 抖音爬虫的编码实现
- 用新的爬虫给扰哥贡献2000条leads

THREAT

THINKING

- 想要的一个功能，三年前就已经有人给scrapy提pr了，但是没有被merge，心疼。Multiple items through item pipelines<https://github.com/scrapy/scrapy/pull/2029>

## 2019-05-10

- 字典服务交接

- 抖音蓝V业务：抖音自动化爬虫在现有爬虫系统中的整合，开发测试阶段补齐一个兼职的人力。  下周一上线，逐步放量，周五实现人力全替代

- 爬虫数据库表清理，包括leads临时表（mongo表，一到两周）的设计与落地（推进如磊定期删）

历史项目总结：

- 百姓店铺，php语言+laravel框架，电商，sku锁、商品管理等，熟悉java的机会
- 百姓逛逛，如何持续维护一个老系统，前端能力
- 媒体服务，桥接云服务与业务应用的桥梁，云服务切换、处理流模板配置
- 字典服务，高并发设计，树形层级结构，缓存，API调用防控，排序算法
- 牧野后台，基于express的node后端框架，vue（组件、双向绑定），配置中心的设计
- 爬虫系统，scrapy框架设计、分布式爬虫、通用爬虫设计、模拟登录、API签名算法、xpath+jsonpath、python类加载、excel文件导出与在线编辑
- 爬虫管理后台，eggjs，ssr同构

## 2019-05-13

- 抖音搜索接口限制，方案：微博登录（切换设备id已做，效果待验证）
- 关注爬虫的cookies问题，以及check抖音接口返回空数据的原因
- 关注一下代理ip经常失败的问题
- 将爬虫部署到dev小规模地跑一跑



## 2019-05-16

### 字典服务交接
##### 老牧野修改了地区数据，怎么办？
1. 找出这些数据
2. 对新增的数据，转成SQL插入语句，放到DB里去执行；对修改的数据（包括更新、软删除）等，转成字典服务的API请求。 
3. 

## 2019-05-17
#### 工作交接清单
-  字典服务以及新牧野后台

	- [ ] 与东辉过一遍代码 （before 05-23）

	- [ ] 将有关问题中相关方的职责明确落地成文档（个人经验与见解），schema这块的相关方包括：大师，调用大师的graphql的前端，字典服务，schema服务，新牧野后台，产品人员；dict这边的相关方包括：车型库更新的小红/尚霖，其他中台服务等（05-20）

- [ ] 媒体内容服务交接文档（05-23）

- 抖音蓝V项目（05-21）

	- [ ] douyin-support、processor/douyin的技术文档补充

	- [x] 下掉 <http://shanghai.baixing.com/p/mkt_douyin_visitors.php>，包括清理相关redis缓存（已清）

- 爬虫相关项目的文档补充（05-22）
   - [ ] spider_common
   - [ ] parser_engine
   - [ ] scheduler

#### 本周工作内容
1 .  抖音自动化爬虫方案：去重后数量的持续性

2. 协助问题：车型库更新、地区库更新

地区库更新问题：5月7日当天在保定m68下新增了一个白沟m191838,



## 2019-05-20

- 爬虫pod扩容，确认了现有架构存在的问题，已向高榕反馈，等待明日答复。
- DW：数据流的bug已经修复；现有存量已经灌入5000+手机号；字段的mapping关系表格已经交付给佳薇。
- 抖音搜索渠道验证：在channel字段加了搜索方法名，可以通过DW查询估计一个量TODO。
- 东辉交接：明确剩余问题，缓存结构图 + 一段数据转换代码（输入是镐京中形如mXX的地区id，输出是该数据对应于dict_area表的insert sql） + 过一遍代码
- 新牧野其他问题：小区更新与家金、东辉一同确定了方案，必要时提供帮助；车型库根据尚霖的反馈，修了一波脚本，调整了线下dict_car表的node_name列字符长度（线上TODO），部分字段类型问题是潜在隐患，已告知东辉；schema相关问题，主要对应的前端开发是十九，确认了部分dictId错误的问题。

## 2019-05-21

- 爬虫pod扩容：高榕女侠又一次鸽了我，然后她又答应我明天答复我，此事暂不紧急。
- 抖音蓝V：截至19:20，今日DW入库抖音用户量201722，其中手机号10080个，剩余线索数量约23万。
- 东辉交接：补了字典服务的缓存结构图，以及字典服务中4张表相关业务的现状；补充了牧野后台的相关文档和代码注释。
- 新牧野其他问题：协助尚霖处理字典服务线上数据库同步到线下的问题以及昨日待做的改表操作；dictId的问题定位到牧野后台的一处bug，已修复上线。
- TODO：
  - 给东辉的那段数据转换代码
  - 完成离职交接需求【爬虫相关项目的文档补充】（明天至少要先完成这部分的初稿！）
  - 过抖音爬虫的PR

## 2019-05-22

- 爬虫pod扩容：与高榕确认了几个点。解决方案：维持现有的扩容方式，比较low；参考**scrapyd-cluster-on-heroku**，比较复杂；改造scrapyd，另外一种复杂。
- 抖音蓝V：截至5月23日9点，自动化方案共计向DW输送19740个leads；5月22日单日输送量1142。
- 东辉交接：与东辉讲解了代码，正式确认交接完毕。
- 爬虫项目交接：parser_engine基本梳理完毕；spider_common TODO
- 抖音项目交接：douyin_support基本梳理完毕；抖音API爬虫 TODO、
- 其他TODO：
  - 抖音API爬虫
    - 现状的详细统计数据
    - scheduler项目中开发关键词模块

## 2019-05-23

- 需要打点补充的数据：
  - 用户已存在（重复抓取）
- 周一10:00以来截至周四12:00，关键词注入近10万，计线索约40万，爬取抖音用户共45万，去重后只有14万，其中手机号9000+不到1万。



周会：

1. 抖音爬虫，关键问题定位为关键词质量差、数量少导致的“重复率”过高，投入精力来解决关键词；其他问题，ip代理相关的策略。
2. 交接：爬虫相关的文档；抖音的正在；字典服务；媒体服务？





验证抖音爬虫的持续性爬取能力，数字报表 风险的数字评估；扩充已有池子的量

媒体内容服务的交接

 

